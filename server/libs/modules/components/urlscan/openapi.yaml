---
openapi: "3.0.0"
info:
  title: "Urlscan.io"
  description: "Urlscan.io is an online service that allows you to safely analyze websites and URLs to determine potential security threats and risks."
  version: "v1"
servers:
  - url: "https://urlscan.io"
paths:
  /api/v1/scan:
    post:
      summary: "Scan"
      description: "Submit a URL to be scanned and control options for how the scan should be performed."
      operationId: "scan"
      x-ai-agent-tool: true
      requestBody:
        content:
          application/json:
            schema:
              title: "Scan"
              type: "object"
              required:
                - url
              properties:
                url:
                  type: "string"
                  title: "URL"
                  description: "The URL to be scanned."
                visibility:
                  type: "string"
                  enum:
                    - public
                    - unlisted
                    - private
                  description: "Intended visibility of the final scan result."
                tags:
                  type: "array"
                  maxItems: "10"
                  items:
                    type: "string"
                  description: "User-defined tags to annotate this scan."
      responses:
        200:
          description: "OK"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  uuid:
                    type: "string"
                    description: "UUID for scan result, also called $scanId."
                  country:
                    type: "string"
                    description: "Country for scanning."
                  visibility:
                    type: "string"
                    description: "Determined visibility for scan."
                  url:
                    type: "string"
                    description: "Determined URL being scanned."
  /api/v1/result/{scanId}/:
    get:
      summary: "Result"
      description: "Using the Scan ID, you can use the Result API to poll for the scan."
      operationId: "result"
      x-ai-agent-tool: true
      parameters:
        - name: "scanId"
          description: "UUID of scan result."
          in: "path"
          required: true
          schema:
            type: "string"
            title: "Scan ID"
      responses:
        200:
          description: "OK"
          content:
            application/json:
              schema:
                type: "object"
                properties:
                  data:
                    type: "object"
                    description: "Raw scan data including network requests, responses, cookies, console logs, and page elements."
                    properties:
                      requests:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            request:
                              type: "object"
                              properties:
                                requestId:
                                  type: "string"
                                loaderId:
                                  type: "string"
                                documentURL:
                                  type: "string"
                                request:
                                  type: "object"
                                  properties:
                                    url:
                                      type: "string"
                                    method:
                                      type: "string"
                                    headers:
                                      type: "object"
                                      additionalProperties:
                                        type: "string"
                                    mixedContentType:
                                      type: "string"
                                    initialPriority:
                                      type: "string"
                                    referrerPolicy:
                                      type: "string"
                                    isSameSite:
                                      type: "boolean"
                                    isLinkPreload:
                                      type: "boolean"
                                timestamp:
                                  type: "number"
                                wallTime:
                                  type: "number"
                                initiator:
                                  type: "object"
                                  properties:
                                    type:
                                      type: "string"
                                    url:
                                      type: "string"
                                    lineNumber:
                                      type: "integer"
                                    columnNumber:
                                      type: "integer"
                                redirectHasExtraInfo:
                                  type: "boolean"
                                type:
                                  type: "string"
                                frameId:
                                  type: "string"
                                hasUserGesture:
                                  type: "boolean"
                                primaryRequest:
                                  type: "boolean"
                            response:
                              type: "object"
                              properties:
                                encodedDataLength:
                                  type: "integer"
                                dataLength:
                                  type: "integer"
                                requestId:
                                  type: "string"
                                type:
                                  type: "string"
                                hasExtraInfo:
                                  type: "boolean"
                                hash:
                                  type: "string"
                                size:
                                  type: "integer"
                                asn:
                                  type: "object"
                                  properties:
                                    ip:
                                      type: "string"
                                    asn:
                                      type: "string"
                                    country:
                                      type: "string"
                                    registrar:
                                      type: "string"
                                    date:
                                      type: "string"
                                    description:
                                      type: "string"
                                    route:
                                      type: "string"
                                    name:
                                      type: "string"
                                geoip:
                                  type: "object"
                                  properties:
                                    country:
                                      type: "string"
                                    region:
                                      type: "string"
                                    timezone:
                                      type: "string"
                                    city:
                                      type: "string"
                                    ll:
                                      type: "array"
                                      items:
                                        type: "number"
                                    country_name:
                                      type: "string"
                                    metro:
                                      type: "integer"
                                    area:
                                      type: "integer"
                                rdns:
                                  type: "object"
                                  properties:
                                    ip:
                                      type: "string"
                                    ptr:
                                      type: "string"
                                response:
                                  type: "object"
                                  properties:
                                    url:
                                      type: "string"
                                    status:
                                      type: "integer"
                                    statusText:
                                      type: "string"
                                    headers:
                                      type: "object"
                                      additionalProperties:
                                        type: "string"
                                    mimeType:
                                      type: "string"
                                    remoteIPAddress:
                                      type: "string"
                                    remotePort:
                                      type: "integer"
                                    encodedDataLength:
                                      type: "integer"
                                    timing:
                                      type: "object"
                                      properties:
                                        requestTime:
                                          type: "number"
                                        proxyStart:
                                          type: "number"
                                        proxyEnd:
                                          type: "number"
                                        dnsStart:
                                          type: "number"
                                        dnsEnd:
                                          type: "number"
                                        connectStart:
                                          type: "number"
                                        connectEnd:
                                          type: "number"
                                        sslStart:
                                          type: "number"
                                        sslEnd:
                                          type: "number"
                                        workerStart:
                                          type: "number"
                                        workerReady:
                                          type: "number"
                                        workerFetchStart:
                                          type: "number"
                                        workerRespondWithSettled:
                                          type: "number"
                                        sendStart:
                                          type: "number"
                                        sendEnd:
                                          type: "number"
                                        pushStart:
                                          type: "number"
                                        pushEnd:
                                          type: "number"
                                        receiveHeadersStart:
                                          type: "number"
                                        receiveHeadersEnd:
                                          type: "number"
                                    responseTime:
                                      type: "number"
                                    protocol:
                                      type: "string"
                                    alternateProtocolUsage:
                                      type: "string"
                                    securityState:
                                      type: "string"
                                    securityDetails:
                                      type: "object"
                                      properties:
                                        protocol:
                                          type: "string"
                                        keyExchange:
                                          type: "string"
                                        keyExchangeGroup:
                                          type: "string"
                                        cipher:
                                          type: "string"
                                        certificateId:
                                          type: "integer"
                                        subjectName:
                                          type: "string"
                                        sanList:
                                          type: "array"
                                          items:
                                            type: "string"
                                        issuer:
                                          type: "string"
                                        validFrom:
                                          type: "integer"
                                        validTo:
                                          type: "integer"
                                        signedCertificateTimestampList:
                                          type: "array"
                                          items:
                                            type: "string"
                                        certificateTransparencyCompliance:
                                          type: "string"
                                        serverSignatureAlgorithm:
                                          type: "integer"
                                        encryptedClientHello:
                                          type: "boolean"
                                    securityHeaders:
                                      type: "array"
                                      items:
                                        type: "object"
                                        properties:
                                          name:
                                            type: "string"
                                          value:
                                            type: "string"
                            initiatorInfo:
                              type: "object"
                              properties:
                                url:
                                  type: "string"
                                host:
                                  type: "string"
                                type:
                                  type: "string"
                      cookies:
                        type: "array"
                        items:
                          type: "object"
                      console:
                        type: "array"
                        items:
                          type: "object"
                      links:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            href:
                              type: "string"
                            text:
                              type: "string"
                      timing:
                        type: "object"
                      globals:
                        type: "array"
                        items:
                          type: "object"
                  stats:
                    type: "object"
                    description: "Statistical analysis of the scan including resource counts, protocols, security metrics, and geographic distribution."
                    properties:
                      resourceStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            count:
                              type: "integer"
                            size:
                              type: "integer"
                            encodedSize:
                              type: "integer"
                            latency:
                              type: "number"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            type:
                              type: "string"
                            compression:
                              type: "string"
                            percentage:
                              type: "integer"
                      protocolStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            count:
                              type: "integer"
                            size:
                              type: "integer"
                            encodedSize:
                              type: "integer"
                            latency:
                              type: "number"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            percentage:
                              type: "integer"
                            protocol:
                              type: "string"
                            securityState:
                              type: "object"
                      tlsStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            count:
                              type: "integer"
                            size:
                              type: "integer"
                            encodedSize:
                              type: "integer"
                            latency:
                              type: "number"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            percentage:
                              type: "integer"
                            protocols:
                              type: "object"
                              additionalProperties:
                                type: "integer"
                            securityState:
                              type: "string"
                      serverStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            count:
                              type: "integer"
                            size:
                              type: "integer"
                            encodedSize:
                              type: "integer"
                            latency:
                              type: "number"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            percentage:
                              type: "integer"
                            server:
                              type: "string"
                      domainStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            count:
                              type: "integer"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            redirects:
                              type: "integer"
                            size:
                              type: "integer"
                            encodedSize:
                              type: "integer"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            index:
                              type: "integer"
                            initiators:
                              type: "array"
                              items:
                                type: "string"
                            requests:
                              type: "integer"
                            domain:
                              type: "string"
                      regDomainStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            count:
                              type: "integer"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            redirects:
                              type: "integer"
                            size:
                              type: "integer"
                            encodedSize:
                              type: "integer"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            index:
                              type: "integer"
                            initiators:
                              type: "array"
                              items:
                                type: "string"
                            requests:
                              type: "integer"
                            regDomain:
                              type: "string"
                            subDomains:
                              type: "array"
                              items:
                                type: "object"
                                properties:
                                  domain:
                                    type: "string"
                                  country:
                                    type: "string"
                      secureRequests:
                        type: "integer"
                      securePercentage:
                        type: "integer"
                      IPv6Percentage:
                        type: "integer"
                      uniqCountries:
                        type: "integer"
                      totalLinks:
                        type: "integer"
                      maliciousRequests:
                        type: "integer"
                      adBlocked:
                        type: "integer"
                      malicious:
                        type: "integer"
                      ipStats:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            requests:
                              type: "integer"
                            domains:
                              type: "array"
                              items:
                                type: "string"
                            ips:
                              type: "array"
                              items:
                                type: "string"
                            countries:
                              type: "array"
                              items:
                                type: "string"
                            asns:
                              type: "array"
                              items:
                                type: "object"
                                properties:
                                  asn:
                                    type: "string"
                                  country:
                                    type: "string"
                                  organisation:
                                    type: "string"
                            encoded_size:
                              type: "integer"
                            size:
                              type: "integer"
                            redirects:
                              type: "integer"
                            ip:
                              type: "string"
                            asn:
                              type: "object"
                              properties:
                                ip:
                                  type: "string"
                                asn:
                                  type: "string"
                                country:
                                  type: "string"
                                registrar:
                                  type: "string"
                                date:
                                  type: "string"
                                description:
                                  type: "string"
                                route:
                                  type: "string"
                                name:
                                  type: "string"
                            dns:
                              type: "object"
                            geoip:
                              type: "object"
                              properties:
                                country:
                                  type: "string"
                                region:
                                  type: "string"
                                timezone:
                                  type: "string"
                                city:
                                  type: "string"
                                ll:
                                  type: "array"
                                  items:
                                    type: "number"
                                country_name:
                                  type: "string"
                                metro:
                                  type: "integer"
                                area:
                                  type: "integer"
                            encodedSize:
                              type: "integer"
                            index:
                              type: "integer"
                            ipv6:
                              type: "boolean"
                            count:
                              type: "integer"
                            rdns:
                              type: "object"
                              properties:
                                ip:
                                  type: "string"
                                ptr:
                                  type: "string"
                  meta:
                    type: "object"
                    description: "Enriched metadata from external processors including domain rankings, geolocation, DNS records, and ASN information."
                    properties:
                      processors:
                        type: "object"
                        properties:
                          umbrella:
                            type: "object"
                            properties:
                              data:
                                type: "array"
                                items:
                                  type: "object"
                                  properties:
                                    hostname:
                                      type: "string"
                                    rank:
                                      type: "integer"
                          geoip:
                            type: "object"
                            properties:
                              data:
                                type: "array"
                                items:
                                  type: "object"
                                  properties:
                                    ip:
                                      type: "string"
                                    geoip:
                                      type: "object"
                                      properties:
                                        country:
                                          type: "string"
                                        country_name:
                                          type: "string"
                                        region:
                                          type: "string"
                                        timezone:
                                          type: "string"
                                        city:
                                          type: "string"
                                        ll:
                                          type: "array"
                                          items:
                                            type: "number"
                                        metro:
                                          type: "integer"
                                        area:
                                          type: "integer"
                          rdns:
                            type: "object"
                            properties:
                              data:
                                type: "array"
                                items:
                                  type: "object"
                                  properties:
                                    ip:
                                      type: "string"
                                    ptr:
                                      type: "string"
                          asn:
                            type: "object"
                            properties:
                              data:
                                type: "array"
                                items:
                                  type: "object"
                                  properties:
                                    ip:
                                      type: "string"
                                    asn:
                                      type: "string"
                                    country:
                                      type: "string"
                                    organisation:
                                      type: "string"
                                    registrar:
                                      type: "string"
                                    date:
                                      type: "string"
                                    description:
                                      type: "string"
                                    route:
                                      type: "string"
                                    name:
                                      type: "string"
                          wappa:
                            type: "object"
                            properties:
                              data:
                                type: "array"
                                items:
                                  type: "object"
                                  properties:
                                    confidence:
                                      type: "array"
                                      items:
                                        type: "object"
                                        properties:
                                          confidence:
                                            type: "integer"
                                          pattern:
                                            type: "string"
                                    confidenceTotal:
                                      type: "integer"
                                    app:
                                      type: "string"
                                    icon:
                                      type: "string"
                                    website:
                                      type: "string"
                                    categories:
                                      type: "array"
                                      items:
                                        type: "object"
                                        properties:
                                          name:
                                            type: "string"
                                          id:
                                            type: "string"
                                          priority:
                                            type: "integer"
                  task:
                    type: "object"
                    description: "Information about the scan task including configuration, URLs, and submission details."
                    properties:
                      uuid:
                        type: "string"
                      time:
                        type: "string"
                      url:
                        type: "string"
                      visibility:
                        type: "string"
                      options:
                        type: "object"
                      method:
                        type: "string"
                      source:
                        type: "string"
                      userAgent:
                        type: "string"
                      reportURL:
                        type: "string"
                      screenshotURL:
                        type: "string"
                      domURL:
                        type: "string"
                      tags:
                        type: "array"
                        items:
                          type: "string"
                  page:
                    type: "object"
                    description: "Information about the scanned page including server details, location and network properties."
                    properties:
                      country:
                        type: "string"
                      server:
                        type: "string"
                      city:
                        type: "string"
                      domain:
                        type: "string"
                      ip:
                        type: "string"
                      asnname:
                        type: "string"
                      asn:
                        type: "string"
                      url:
                        type: "string"
                      ptr:
                        type: "string"
                  lists:
                    type: "object"
                    description: "Aggregated lists of unique elements found during the scan including IPs, domains, URLs, and certificates."
                    properties:
                      ips:
                        type: "array"
                        items:
                          type: "string"
                      countries:
                        type: "array"
                        items:
                          type: "string"
                      asns:
                        type: "array"
                        items:
                          type: "string"
                      domains:
                        type: "array"
                        items:
                          type: "string"
                      servers:
                        type: "array"
                        items:
                          type: "string"
                      urls:
                        type: "array"
                        items:
                          type: "string"
                      linkDomains:
                        type: "array"
                        items:
                          type: "string"
                      certificates:
                        type: "array"
                        items:
                          type: "object"
                          properties:
                            subjectName:
                              type: "string"
                            issuer:
                              type: "string"
                            validFrom:
                              type: "integer"
                            validTo:
                              type: "integer"
                      hashes:
                        type: "array"
                        items:
                          type: "string"
                  verdicts:
                    type: "object"
                    description: "Security verdicts and threat analysis from multiple sources including urlscan.io, third-party engines, and community ratings."
                    properties:
                      overall:
                        type: "object"
                        properties:
                          score:
                            type: "integer"
                          categories:
                            type: "array"
                            items:
                              type: "string"
                          brands:
                            type: "array"
                            items:
                              type: "object"
                          tags:
                            type: "array"
                            items:
                              type: "string"
                          malicious:
                            type: "boolean"
                          hasVerdicts:
                            type: "boolean"
                      urlscan:
                        type: "object"
                        properties:
                          score:
                            type: "integer"
                          categories:
                            type: "array"
                            items:
                              type: "string"
                          brands:
                            type: "array"
                            items:
                              type: "object"
                          tags:
                            type: "array"
                            items:
                              type: "string"
                          malicious:
                            type: "boolean"
                          hasVerdicts:
                            type: "boolean"
                      engines:
                        type: "object"
                        properties:
                          score:
                            type: "integer"
                          categories:
                            type: "array"
                            items:
                              type: "string"
                          brands:
                            type: "array"
                            items:
                              type: "object"
                          tags:
                            type: "array"
                            items:
                              type: "string"
                          malicious:
                            type: "boolean"
                          enginesTotal:
                            type: "integer"
                          maliciousTotal:
                            type: "integer"
                          benignTotal:
                            type: "integer"
                          verdicts:
                            type: "array"
                            items:
                              type: "object"
                              properties:
                                engine:
                                  type: "string"
                                classification:
                                  type: "string"
                          maliciousVerdicts:
                            type: "array"
                            items:
                              type: "object"
                          benignVerdicts:
                            type: "array"
                            items:
                              type: "object"
                          hasVerdicts:
                            type: "boolean"
                      community:
                        type: "object"
                        properties:
                          score:
                            type: "integer"
                          categories:
                            type: "array"
                            items:
                              type: "string"
                          brands:
                            type: "array"
                            items:
                              type: "object"
                          tags:
                            type: "array"
                            items:
                              type: "string"
                          malicious:
                            type: "boolean"
                          votesBenign:
                            type: "integer"
                          votesMalicious:
                            type: "integer"
                          votesTotal:
                            type: "integer"
                          hasVerdicts:
                            type: "boolean"
                  submitter:
                    type: "object"
                    description: "Information about the entity that submitted the scan request."
                    properties:
                      country:
                        type: "string"
  /screenshots/{scanId}.png:
    get:
      summary: "Screenshot"
      description: "Use the scan UUID to retrieve the screenshot for a scan once the scan has finished."
      operationId: "screenshot"
      x-ai-agent-tool: true
      parameters:
        - name: "scanId"
          description: "UUID of scan result."
          in: "path"
          required: true
          schema:
            type: "string"
      responses:
        200:
          description: "Successful response"
          content:
            image/png:
              schema:
                type: "string"
                format: "binary"

components:
  securitySchemes:
    apikeyAuth:
      type: "apiKey"
      in: "header"
      name: "api-key"
